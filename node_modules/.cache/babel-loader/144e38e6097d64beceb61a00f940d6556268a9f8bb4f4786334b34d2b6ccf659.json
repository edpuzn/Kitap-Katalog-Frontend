{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport FormTag from './forms/FormTag.vue';\nimport TextInput from './forms/TextInput.vue';\nimport { store } from './store.js';\nimport router from './../router/index.js';\nimport notie from 'notie';\nimport Security from './security.js';\nexport default {\n  name: 'login',\n  components: {\n    FormTag,\n    TextInput\n  },\n  data() {\n    return {\n      email: \"\",\n      password: \"\",\n      store\n    };\n  },\n  methods: {\n    submitHandler() {\n      const payload = {\n        email: this.email,\n        password: this.password\n      };\n      fetch(process.env.VUE_APP_API_URL + \"/users/login\", Security.requestOptions(payload)).then(response => response.json()).then(response => {\n        if (response.error) {\n          notie.alert({\n            type: 'error',\n            text: response.message\n            // stay: true,\n            // position: 'bottom',\n          });\n        } else {\n          store.token = response.data.token.token;\n          store.user = {\n            id: response.data.user.id,\n            first_name: response.data.user.first_name,\n            last_name: response.data.user.last_name,\n            email: response.data.user.email\n          };\n\n          // save info to cookie\n          let date = new Date();\n          let expDays = 1;\n          date.setTime(date.getTime() + expDays * 24 * 60 * 60 * 1000);\n          const expires = \"expires=\" + date.toUTCString();\n\n          // set the cookie\n          document.cookie = \"_site_data=\" + JSON.stringify(response.data) + \"; \" + expires + \"; path=/; SameSite=strict; Secure;\";\n          router.push(\"/\");\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["FormTag","TextInput","store","router","notie","Security","name","components","data","email","password","methods","submitHandler","payload","fetch","process","env","VUE_APP_API_URL","requestOptions","then","response","json","error","alert","type","text","message","token","user","id","first_name","last_name","date","Date","expDays","setTime","getTime","expires","toUTCString","document","cookie","JSON","stringify","push"],"sources":["/Users/ed1p_/MovieProject/frontend/src/components/Login.vue"],"sourcesContent":["<template>\n    <div class=\"container\">\n        <div class=\"row\">\n            <div class=\"col\">\n                <h1 class=\"mt-5\">Login</h1>\n                <hr>\n                <form-tag @myevent=\"submitHandler\" name=\"myform\" event=\"myevent\">\n\n                    <text-input\n                        v-model=\"email\"\n                        label=\"Email\"\n                        type=\"email\"\n                        name=\"email\"\n                        required=\"true\">\n                    </text-input>\n\n                    <text-input\n                        v-model=\"password\"\n                        label=\"Password\"\n                        type=\"password\"\n                        name=\"password\"\n                        required=\"true\">\n                    </text-input>\n\n                    <hr>\n\n                    <input type=\"submit\" class=\"btn btn-primary\" value=\"Login\">\n                </form-tag>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport FormTag from './forms/FormTag.vue'\nimport TextInput from './forms/TextInput.vue'\nimport { store } from './store.js'\nimport router from './../router/index.js'\nimport notie from 'notie'\nimport Security from './security.js'\n\nexport default {\n    name: 'login',\n    components: {\n        FormTag,\n        TextInput,\n    },\n    data() {\n        return {\n            email: \"\",\n            password: \"\",\n            store,\n        }\n    },\n    methods: {\n        submitHandler() {\n            const payload = {\n                email: this.email,\n                password: this.password,\n            }\n\n            fetch(process.env.VUE_APP_API_URL + \"/users/login\", Security.requestOptions(payload))\n            .then((response) => response.json())\n            .then((response) => {\n                if (response.error) {\n                    notie.alert({\n                        type: 'error',\n                        text: response.message,\n                        // stay: true,\n                        // position: 'bottom',\n                    })\n                } else {\n                    store.token = response.data.token.token;\n\n                    store.user = {\n                        id: response.data.user.id,\n                        first_name: response.data.user.first_name,\n                        last_name: response.data.user.last_name,\n                        email: response.data.user.email,\n                    }\n\n                    // save info to cookie\n                    let date = new Date();\n                    let expDays = 1;\n                    date.setTime(date.getTime() + (expDays * 24 * 60 * 60 * 1000));\n                    const expires = \"expires=\" + date.toUTCString();\n\n                    // set the cookie\n                    document.cookie = \"_site_data=\"\n                    + JSON.stringify(response.data)\n                    + \"; \"\n                    + expires\n                    + \"; path=/; SameSite=strict; Secure;\"\n                    router.push(\"/\");\n                }\n            })\n        }\n    }\n}\n</script>"],"mappings":";AAkCA,OAAOA,OAAM,MAAO,qBAAoB;AACxC,OAAOC,SAAQ,MAAO,uBAAsB;AAC5C,SAASC,KAAI,QAAS,YAAW;AACjC,OAAOC,MAAK,MAAO,sBAAqB;AACxC,OAAOC,KAAI,MAAO,OAAM;AACxB,OAAOC,QAAO,MAAO,eAAc;AAEnC,eAAe;EACXC,IAAI,EAAE,OAAO;EACbC,UAAU,EAAE;IACRP,OAAO;IACPC;EACJ,CAAC;EACDO,IAAIA,CAAA,EAAG;IACH,OAAO;MACHC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZR;IACJ;EACJ,CAAC;EACDS,OAAO,EAAE;IACLC,aAAaA,CAAA,EAAG;MACZ,MAAMC,OAAM,GAAI;QACZJ,KAAK,EAAE,IAAI,CAACA,KAAK;QACjBC,QAAQ,EAAE,IAAI,CAACA;MACnB;MAEAI,KAAK,CAACC,OAAO,CAACC,GAAG,CAACC,eAAc,GAAI,cAAc,EAAEZ,QAAQ,CAACa,cAAc,CAACL,OAAO,CAAC,EACnFM,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,EAClCF,IAAI,CAAEC,QAAQ,IAAK;QAChB,IAAIA,QAAQ,CAACE,KAAK,EAAE;UAChBlB,KAAK,CAACmB,KAAK,CAAC;YACRC,IAAI,EAAE,OAAO;YACbC,IAAI,EAAEL,QAAQ,CAACM;YACf;YACA;UACJ,CAAC;QACL,OAAO;UACHxB,KAAK,CAACyB,KAAI,GAAIP,QAAQ,CAACZ,IAAI,CAACmB,KAAK,CAACA,KAAK;UAEvCzB,KAAK,CAAC0B,IAAG,GAAI;YACTC,EAAE,EAAET,QAAQ,CAACZ,IAAI,CAACoB,IAAI,CAACC,EAAE;YACzBC,UAAU,EAAEV,QAAQ,CAACZ,IAAI,CAACoB,IAAI,CAACE,UAAU;YACzCC,SAAS,EAAEX,QAAQ,CAACZ,IAAI,CAACoB,IAAI,CAACG,SAAS;YACvCtB,KAAK,EAAEW,QAAQ,CAACZ,IAAI,CAACoB,IAAI,CAACnB;UAC9B;;UAEA;UACA,IAAIuB,IAAG,GAAI,IAAIC,IAAI,CAAC,CAAC;UACrB,IAAIC,OAAM,GAAI,CAAC;UACfF,IAAI,CAACG,OAAO,CAACH,IAAI,CAACI,OAAO,CAAC,IAAKF,OAAM,GAAI,EAAC,GAAI,EAAC,GAAI,EAAC,GAAI,IAAK,CAAC;UAC9D,MAAMG,OAAM,GAAI,UAAS,GAAIL,IAAI,CAACM,WAAW,CAAC,CAAC;;UAE/C;UACAC,QAAQ,CAACC,MAAK,GAAI,aAAY,GAC5BC,IAAI,CAACC,SAAS,CAACtB,QAAQ,CAACZ,IAAI,IAC5B,IAAG,GACH6B,OAAM,GACN,oCAAmC;UACrClC,MAAM,CAACwC,IAAI,CAAC,GAAG,CAAC;QACpB;MACJ,CAAC;IACL;EACJ;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}