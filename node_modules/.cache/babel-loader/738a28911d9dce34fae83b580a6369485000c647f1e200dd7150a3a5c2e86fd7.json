{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { store } from './store.js';\nimport router from './../router/index.js';\nlet Security = {\n  // make sure user is authenticated\n  requireToken: function () {\n    if (store.token === '') {\n      router.push(\"/login\");\n      return false;\n    }\n  },\n  // create request options and send them back\n  requestOptions: function (payload) {\n    const headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    headers.append(\"Authorization\", \"Bearer \" + store.token);\n    return {\n      method: \"POST\",\n      body: JSON.stringify(payload),\n      headers: headers\n    };\n  },\n  // check token\n  checkToken: function () {\n    if (store.token !== \"\") {\n      const payload = {\n        token: store.token\n      };\n      const headers = new Headers();\n      headers.append(\"Content-Type\", \"application/json\");\n      let requestOptions = {\n        method: \"POST\",\n        body: JSON.stringify(payload),\n        headers: headers\n      };\n      fetch(process.env.VUE_APP_API_URL + \"/validate-token\", requestOptions).then(response => response.json()).then(data => {\n        if (data.error) {\n          console.log(data.error);\n        } else {\n          if (!data.data) {\n            store.token = \"\";\n            store.user = {}, document.cookie = '_site_data=; Path=/; ' + 'SameSite=strict; Secure; ' + 'Expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n          }\n        }\n      });\n    }\n  }\n};\nexport default Security;","map":{"version":3,"names":["store","router","Security","requireToken","token","push","requestOptions","payload","headers","Headers","append","method","body","JSON","stringify","checkToken","fetch","process","env","VUE_APP_API_URL","then","response","json","data","error","console","log","user","document","cookie"],"sources":["/Users/ed1p_/MovieProject/frontend/src/components/security.js"],"sourcesContent":["import {store} from './store.js'\nimport router from './../router/index.js'\n\nlet Security = {\n    // make sure user is authenticated\n    requireToken: function() {\n        if (store.token === '') {\n            router.push(\"/login\");\n            return false\n        }\n    },\n\n    // create request options and send them back\n    requestOptions: function(payload) {\n        const headers = new Headers();\n        headers.append(\"Content-Type\", \"application/json\");\n        headers.append(\"Authorization\", \"Bearer \" + store.token);\n\n        return {\n            method: \"POST\",\n            body: JSON.stringify(payload),\n            headers: headers,\n        }\n    },\n\n    // check token\n    checkToken: function() {\n        if (store.token !== \"\") {\n            const payload = {\n                token: store.token,\n            }\n\n            const headers = new Headers();\n            headers.append(\"Content-Type\", \"application/json\");\n\n            let requestOptions = {\n                method: \"POST\",\n                body: JSON.stringify(payload),\n                headers: headers,\n            }\n\n            fetch(process.env.VUE_APP_API_URL + \"/validate-token\", requestOptions)\n                .then((response) => response.json())\n                .then((data) => {\n                    if (data.error) {\n                        console.log(data.error);\n                    } else {\n                        if (!data.data) {\n                            store.token = \"\";\n                            store.user = {},\n                                document.cookie = '_site_data=; Path=/; '\n                                    + 'SameSite=strict; Secure; '\n                                    + 'Expires=Thu, 01 Jan 1970 00:00:01 GMT;'\n                        }\n                    }\n                })\n        }\n    }\n}\n\nexport default Security;"],"mappings":";AAAA,SAAQA,KAAK,QAAO,YAAY;AAChC,OAAOC,MAAM,MAAM,sBAAsB;AAEzC,IAAIC,QAAQ,GAAG;EACX;EACAC,YAAY,EAAE,SAAAA,CAAA,EAAW;IACrB,IAAIH,KAAK,CAACI,KAAK,KAAK,EAAE,EAAE;MACpBH,MAAM,CAACI,IAAI,CAAC,QAAQ,CAAC;MACrB,OAAO,KAAK;IAChB;EACJ,CAAC;EAED;EACAC,cAAc,EAAE,SAAAA,CAASC,OAAO,EAAE;IAC9B,MAAMC,OAAO,GAAG,IAAIC,OAAO,CAAC,CAAC;IAC7BD,OAAO,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;IAClDF,OAAO,CAACE,MAAM,CAAC,eAAe,EAAE,SAAS,GAAGV,KAAK,CAACI,KAAK,CAAC;IAExD,OAAO;MACHO,MAAM,EAAE,MAAM;MACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACP,OAAO,CAAC;MAC7BC,OAAO,EAAEA;IACb,CAAC;EACL,CAAC;EAED;EACAO,UAAU,EAAE,SAAAA,CAAA,EAAW;IACnB,IAAIf,KAAK,CAACI,KAAK,KAAK,EAAE,EAAE;MACpB,MAAMG,OAAO,GAAG;QACZH,KAAK,EAAEJ,KAAK,CAACI;MACjB,CAAC;MAED,MAAMI,OAAO,GAAG,IAAIC,OAAO,CAAC,CAAC;MAC7BD,OAAO,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;MAElD,IAAIJ,cAAc,GAAG;QACjBK,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACP,OAAO,CAAC;QAC7BC,OAAO,EAAEA;MACb,CAAC;MAEDQ,KAAK,CAACC,OAAO,CAACC,GAAG,CAACC,eAAe,GAAG,iBAAiB,EAAEb,cAAc,CAAC,CACjEc,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACnCF,IAAI,CAAEG,IAAI,IAAK;QACZ,IAAIA,IAAI,CAACC,KAAK,EAAE;UACZC,OAAO,CAACC,GAAG,CAACH,IAAI,CAACC,KAAK,CAAC;QAC3B,CAAC,MAAM;UACH,IAAI,CAACD,IAAI,CAACA,IAAI,EAAE;YACZvB,KAAK,CAACI,KAAK,GAAG,EAAE;YAChBJ,KAAK,CAAC2B,IAAI,GAAG,CAAC,CAAC,EACXC,QAAQ,CAACC,MAAM,GAAG,uBAAuB,GACnC,2BAA2B,GAC3B,wCAAwC;UACtD;QACJ;MACJ,CAAC,CAAC;IACV;EACJ;AACJ,CAAC;AAED,eAAe3B,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}