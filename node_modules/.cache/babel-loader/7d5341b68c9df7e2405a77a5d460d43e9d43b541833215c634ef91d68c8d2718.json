{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport FormTag from './forms/FormTag.vue';\nimport TextInput from './forms/TextInput.vue';\nimport { store } from './store.js';\nimport router from \"@/router\";\nimport notie from \"notie/dist/notie\";\nimport security from \"@/components/security\";\nexport default {\n  // eslint-disable-next-line\n  name: 'login',\n  components: {\n    FormTag,\n    TextInput\n  },\n  data() {\n    return {\n      email: \"\",\n      password: \"\",\n      store\n    };\n  },\n  methods: {\n    submitHandler() {\n      console.log(\"submitHandler called - success!\");\n      const payload = {\n        email: this.email,\n        password: this.password\n      };\n      const requestOptions = {\n        method: \"POST\",\n        body: JSON.stringify(payload)\n      };\n      fetch(process.env.VUE_APP_API_URL + \"/users/login\", requestOptions).then(response => response.json()).then(response => {\n        if (response.error) {\n          console.log(\"Error:\", response.message);\n          notie.alert({\n            type: 'error',\n            text: response.message\n            // stay: true,\n            // position: 'bottom',\n          });\n        } else {\n          console.log(\"Token:\", response.data.token.token);\n          store.token = response.data.token.token;\n          store.user = {\n            id: response.data.user.id,\n            first_name: response.data.user.first_name,\n            last_name: response.data.user.last_name,\n            email: response.data.user.email\n          };\n\n          // save info to cookie\n          let date = new Date();\n          let expDays = 1;\n          date.setTime(date.getTime() + expDays * 24 * 60 * 60 * 1000);\n          const expires = \"expires=\" + date.toUTCString();\n\n          // set the cookie\n          document.cookie = \"_site_data=\" + JSON.stringify(response.data) + \"; \" + expires + \"; path=/; SameSite=strict; Secure;\";\n          router.push(\"/\");\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["FormTag","TextInput","store","router","notie","security","name","components","data","email","password","methods","submitHandler","console","log","payload","requestOptions","method","body","JSON","stringify","fetch","process","env","VUE_APP_API_URL","then","response","json","error","message","alert","type","text","token","user","id","first_name","last_name","date","Date","expDays","setTime","getTime","expires","toUTCString","document","cookie","push"],"sources":["/Users/ed1p_/MovieProject/frontend/src/components/Login.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col\">\n        <h1 class=\"mt-5\">Login</h1>\n        <hr>\n        <form-tag @myevent=\"submitHandler\" name=\"myform\" event=\"myevent\">\n\n          <text-input\n              v-model=\"email\"\n              label=\"Email\"\n              type=\"email\"\n              name=\"email\"\n              required=\"true\">\n          </text-input>\n\n          <text-input\n              v-model=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              name=\"password\"\n              required=\"true\">\n          </text-input>\n\n          <hr>\n          <input type=\"submit\" class=\"btn btn-primary\" value=\"Login\">\n        </form-tag>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport FormTag from './forms/FormTag.vue'\nimport TextInput from './forms/TextInput.vue'\nimport { store } from './store.js'\nimport router from \"@/router\";\nimport notie from \"notie/dist/notie\";\nimport security from \"@/components/security\";\nexport default {\n  // eslint-disable-next-line\n  name: 'login',\n  components: {\n    FormTag,\n    TextInput,\n  },\n  data() {\n    return {\n      email: \"\",\n      password: \"\",\n      store,\n    }\n  },\n  methods: {\n    submitHandler() {\n      console.log(\"submitHandler called - success!\");\n\n      const payload = {\n        email: this.email,\n        password: this.password,\n      }\n\n      const requestOptions = {\n        method: \"POST\",\n        body: JSON.stringify(payload),\n      }\n      fetch(process.env.VUE_APP_API_URL+\"/users/login\", requestOptions)\n          .then((response) => response.json())\n          .then((response) => {\n            if (response.error) {\n              console.log(\"Error:\", response.message);\n              notie.alert({\n                type: 'error',\n                text: response.message,\n                // stay: true,\n                // position: 'bottom',\n              })\n            } else {\n              console.log(\"Token:\", response.data.token.token);\n              store.token = response.data.token.token;\n\n              store.user = {\n                id: response.data.user.id,\n                first_name: response.data.user.first_name,\n                last_name: response.data.user.last_name,\n                email: response.data.user.email,\n              }\n\n              // save info to cookie\n              let date = new Date();\n              let expDays = 1;\n              date.setTime(date.getTime() + (expDays * 24 * 60 * 60 * 1000));\n              const expires = \"expires=\" + date.toUTCString();\n\n              // set the cookie\n              document.cookie = \"_site_data=\"\n                  + JSON.stringify(response.data)\n                  + \"; \"\n                  + expires\n                  + \"; path=/; SameSite=strict; Secure;\"\n              router.push(\"/\");\n            }\n          })\n    }\n  }\n}\n</script>"],"mappings":";AAiCA,OAAOA,OAAM,MAAO,qBAAoB;AACxC,OAAOC,SAAQ,MAAO,uBAAsB;AAC5C,SAASC,KAAI,QAAS,YAAW;AACjC,OAAOC,MAAK,MAAO,UAAU;AAC7B,OAAOC,KAAI,MAAO,kBAAkB;AACpC,OAAOC,QAAO,MAAO,uBAAuB;AAC5C,eAAe;EACb;EACAC,IAAI,EAAE,OAAO;EACbC,UAAU,EAAE;IACVP,OAAO;IACPC;EACF,CAAC;EACDO,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZR;IACF;EACF,CAAC;EACDS,OAAO,EAAE;IACPC,aAAaA,CAAA,EAAG;MACdC,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;MAE9C,MAAMC,OAAM,GAAI;QACdN,KAAK,EAAE,IAAI,CAACA,KAAK;QACjBC,QAAQ,EAAE,IAAI,CAACA;MACjB;MAEA,MAAMM,cAAa,GAAI;QACrBC,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACL,OAAO;MAC9B;MACAM,KAAK,CAACC,OAAO,CAACC,GAAG,CAACC,eAAe,GAAC,cAAc,EAAER,cAAc,EAC3DS,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,EAClCF,IAAI,CAAEC,QAAQ,IAAK;QAClB,IAAIA,QAAQ,CAACE,KAAK,EAAE;UAClBf,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEY,QAAQ,CAACG,OAAO,CAAC;UACvCzB,KAAK,CAAC0B,KAAK,CAAC;YACVC,IAAI,EAAE,OAAO;YACbC,IAAI,EAAEN,QAAQ,CAACG;YACf;YACA;UACF,CAAC;QACH,OAAO;UACLhB,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEY,QAAQ,CAAClB,IAAI,CAACyB,KAAK,CAACA,KAAK,CAAC;UAChD/B,KAAK,CAAC+B,KAAI,GAAIP,QAAQ,CAAClB,IAAI,CAACyB,KAAK,CAACA,KAAK;UAEvC/B,KAAK,CAACgC,IAAG,GAAI;YACXC,EAAE,EAAET,QAAQ,CAAClB,IAAI,CAAC0B,IAAI,CAACC,EAAE;YACzBC,UAAU,EAAEV,QAAQ,CAAClB,IAAI,CAAC0B,IAAI,CAACE,UAAU;YACzCC,SAAS,EAAEX,QAAQ,CAAClB,IAAI,CAAC0B,IAAI,CAACG,SAAS;YACvC5B,KAAK,EAAEiB,QAAQ,CAAClB,IAAI,CAAC0B,IAAI,CAACzB;UAC5B;;UAEA;UACA,IAAI6B,IAAG,GAAI,IAAIC,IAAI,CAAC,CAAC;UACrB,IAAIC,OAAM,GAAI,CAAC;UACfF,IAAI,CAACG,OAAO,CAACH,IAAI,CAACI,OAAO,CAAC,IAAKF,OAAM,GAAI,EAAC,GAAI,EAAC,GAAI,EAAC,GAAI,IAAK,CAAC;UAC9D,MAAMG,OAAM,GAAI,UAAS,GAAIL,IAAI,CAACM,WAAW,CAAC,CAAC;;UAE/C;UACAC,QAAQ,CAACC,MAAK,GAAI,aAAY,GACxB3B,IAAI,CAACC,SAAS,CAACM,QAAQ,CAAClB,IAAI,IAC5B,IAAG,GACHmC,OAAM,GACN,oCAAmC;UACzCxC,MAAM,CAAC4C,IAAI,CAAC,GAAG,CAAC;QAClB;MACF,CAAC;IACP;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}